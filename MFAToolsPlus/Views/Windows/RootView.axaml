<suki:SukiWindow xmlns="https://github.com/avaloniaui"
                 xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
                 xmlns:vm="using:MFAToolsPlus.ViewModels"
                 xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
                 xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
                 xmlns:suki="https://github.com/kikipoulet/SukiUI"
                 xmlns:helper="clr-namespace:MFAToolsPlus.Helper"
                 xmlns:markup="https://codewf.com"
                 xmlns:fluent="clr-namespace:FluentIcons.Avalonia.Fluent.Markup;assembly=FluentIcons.Avalonia.Fluent"
                 xmlns:extensions="clr-namespace:MFAToolsPlus.Extensions"
                 xmlns:pages="clr-namespace:MFAToolsPlus.Views.Pages"
                 mc:Ignorable="d"
                 x:Class="MFAToolsPlus.Views.RootView"
                 x:DataType="vm:RootViewModel"
                 Icon="{x:Static helper:IconHelper.WindowIcon}"
                 BackgroundAnimationEnabled="{Binding BackgroundAnimations, Source={x:Static helper:Instances.GuiSettingsUserControlModel}}"
                 BackgroundStyle="{Binding BackgroundStyle, Source={x:Static helper:Instances.GuiSettingsUserControlModel}}"
                 BackgroundTransitionsEnabled="{Binding BackgroundTransitions, Source={x:Static helper:Instances.GuiSettingsUserControlModel}}"
                 BackgroundImage="{Binding BackgroundImage, Source={x:Static helper:Instances.GuiSettingsUserControlModel}}"
                 BackgroundImageOpacity="{Binding BackgroundImageOpacity, Source={x:Static helper:Instances.GuiSettingsUserControlModel}}"
                 IsVisible="{Binding IsWindowVisible}"
                 MinHeight="360" CanPin="True"
                 MinWidth="700"
                 d:DesignHeight="450"
                 d:DesignWidth="800" ShowTitle="False">
    <suki:SukiWindow.LogoContent>
        <Image
            Height="24"
            Source="{x:Static helper:IconHelper.Icon}"
            Stretch="Uniform"
            Width="24" />

    </suki:SukiWindow.LogoContent>
    <suki:SukiWindow.NonClientAreaContent>
        <StackPanel Orientation="Horizontal" Spacing="5">
            <Button HorizontalAlignment="Left" VerticalContentAlignment="Center" VerticalAlignment="Center"
                    Classes="Basic" Cursor="Hand" Command="{Binding TryUpdateCommand}" IsHitTestVisible="True"
                    IsVisible="{Binding WindowUpdateInfo, Converter={x:Static StringConverters.IsNotNullOrEmpty}}">
                <TextBlock
                    VerticalAlignment="Center"
                    Text="{Binding WindowUpdateInfo}">
                    <TextBlock.Foreground>
                        <LinearGradientBrush StartPoint="0%,0%" EndPoint="100%,0%">
                            <GradientStop Color="#FF4285F4" Offset="0.0" />
                            <GradientStop Color="#FFEA4335" Offset="1.0" />
                        </LinearGradientBrush>
                    </TextBlock.Foreground>
                    <TextBlock.Styles>
                        <Style Selector="TextBlock">
                            <Style.Animations>
                                <!-- 总时长4秒，无限循环，与WPF的4个1秒动画段对应 -->
                                <Animation Duration="0:0:2" IterationCount="INFINITE" FillMode="Forward">
                                    <!-- 关键帧1：0%（0秒）→ 主色：蓝色(#FF4285F4)，流动渐变从蓝到红 -->
                                    <KeyFrame Cue="0%">
                                        <KeyFrame.Setters>
                                            <Setter Property="Foreground">
                                                <Setter.Value>
                                                    <LinearGradientBrush StartPoint="0%,0%" EndPoint="100%,0%">
                                                        <GradientStop Color="#FF4285F4" Offset="0.0" />
                                                        <GradientStop Color="#FFEA4335" Offset="1.0" />
                                                    </LinearGradientBrush>
                                                </Setter.Value>
                                            </Setter>
                                        </KeyFrame.Setters>
                                    </KeyFrame>

                                    <!-- 关键帧2：25%（1秒）→ 主色：红色(#FFEA4335)，流动渐变从红到黄 -->
                                    <KeyFrame Cue="25%">
                                        <KeyFrame.Setters>
                                            <Setter Property="Foreground">
                                                <Setter.Value>
                                                    <LinearGradientBrush StartPoint="0%,0%" EndPoint="100%,0%">
                                                        <GradientStop Color="#FFEA4335" Offset="0.0" />
                                                        <GradientStop Color="#FFFBBC05" Offset="1.0" />
                                                    </LinearGradientBrush>
                                                </Setter.Value>
                                            </Setter>
                                        </KeyFrame.Setters>
                                    </KeyFrame>

                                    <!-- 关键帧3：50%（2秒）→ 主色：黄色(#FFFBBC05)，流动渐变从黄到绿 -->
                                    <KeyFrame Cue="50%">
                                        <KeyFrame.Setters>
                                            <Setter Property="Foreground">
                                                <Setter.Value>
                                                    <LinearGradientBrush StartPoint="0%,0%" EndPoint="100%,0%">
                                                        <GradientStop Color="#FFFBBC05" Offset="0.0" />
                                                        <GradientStop Color="#FF34A853" Offset="1.0" />
                                                    </LinearGradientBrush>
                                                </Setter.Value>
                                            </Setter>
                                        </KeyFrame.Setters>
                                    </KeyFrame>

                                    <!-- 关键帧4：75%（3秒）→ 主色：绿色(#FF34A853)，流动渐变从绿到蓝 -->
                                    <KeyFrame Cue="75%">
                                        <KeyFrame.Setters>
                                            <Setter Property="Foreground">
                                                <Setter.Value>
                                                    <LinearGradientBrush StartPoint="0%,0%" EndPoint="100%,0%">
                                                        <GradientStop Color="#FF34A853" Offset="0.0" />
                                                        <GradientStop Color="#FF4285F4" Offset="1.0" />
                                                    </LinearGradientBrush>
                                                </Setter.Value>
                                            </Setter>
                                        </KeyFrame.Setters>
                                    </KeyFrame>
                                    <KeyFrame Cue="100%">
                                        <KeyFrame.Setters>
                                            <Setter Property="Foreground">
                                                <Setter.Value>
                                                    <LinearGradientBrush StartPoint="0%,0%" EndPoint="100%,0%">
                                                        <GradientStop Color="#FF4285F4" Offset="0.0" />
                                                        <GradientStop Color="#FFEA4335" Offset="1.0" />
                                                    </LinearGradientBrush>
                                                </Setter.Value>
                                            </Setter>
                                        </KeyFrame.Setters>
                                    </KeyFrame>
                                </Animation>
                            </Style.Animations>
                        </Style>
                    </TextBlock.Styles>
                </TextBlock>
            </Button>


            <TextBlock VerticalAlignment="Center"
                       FontSize="13" Text="{markup:I18n {x:Static helper:LangKeys.AppTitle}}" IsHitTestVisible="False"
                       FontWeight="Bold" />
            <TextBlock VerticalAlignment="Center" Margin="5 0 0 0" 
                       Foreground="{DynamicResource SukiLowText}" IsHitTestVisible="False"
                       FontSize="13" Text="{x:Static vm:RootViewModel.Version}" />
        </StackPanel>
    </suki:SukiWindow.NonClientAreaContent>
    <suki:SukiWindow.Hosts>
        <suki:SukiToastHost Manager="{x:Static helper:Instances.ToastManager}" />
        <suki:SukiDialogHost Manager="{x:Static helper:Instances.DialogManager}" Name="DialogHost" />
    </suki:SukiWindow.Hosts>
    <Design.DataContext>
        <vm:RootViewModel />
    </Design.DataContext>
    <Grid>
        <suki:SukiSideMenu IsMenuExpanded="False" IsSearchEnabled="False" OpenPaneLength="150">
            <suki:SukiSideMenu.Items>
                <suki:SukiSideMenuItem IsContentMovable="False"
                                       Header="{markup:I18n {x:Static helper:LangKeys.Home}}"
                                       Icon="{fluent:FluentIcon Icon=TasksApp,
                                                       IconVariant=Regular}"
                                       PageContent="{extensions:ServiceProvider ServiceType={x:Type pages:ToolsView}}" />
            </suki:SukiSideMenu.Items>

            <suki:SukiSideMenu.HeaderContent>
                <!--  Header Content  -->
            </suki:SukiSideMenu.HeaderContent>

            <suki:SukiSideMenu.FooterMenuItems>
                <suki:SukiSideMenuItem IsContentMovable="False"
                                       Header="{markup:I18n {x:Static helper:LangKeys.Settings}}"
                                       Icon="{fluent:FluentIcon Icon=Settings,
                                                           IconVariant=Regular}"
                                       PageContent="{extensions:ServiceProvider ServiceType={x:Type pages:SettingsView}}" />
            </suki:SukiSideMenu.FooterMenuItems>
        </suki:SukiSideMenu>
        <Canvas x:Name="BubbleLayer"
                IsHitTestVisible="False"
                Panel.ZIndex="99" />
    </Grid>
</suki:SukiWindow>